# ğŸ“Š Cloudflare D1 æ•°æ®åº“é…ç½®æ•™ç¨‹

## ğŸ¯ é—®é¢˜ï¼šç½‘ç«™æ‰“ä¸å¼€ï¼Ÿ

å¦‚æœæ‚¨å·²ç»ä¸Šä¼ äº† `fiverr-deploy.zip` åˆ° Cloudflare Pagesï¼Œä½†ç½‘ç«™æ‰“ä¸å¼€ï¼Œå¾ˆå¯èƒ½æ˜¯å› ä¸º**æ•°æ®åº“è¿˜æ²¡æœ‰é…ç½®**ã€‚

---

## âœ… å®Œæ•´é…ç½®æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»º D1 æ•°æ®åº“ï¼ˆ2åˆ†é’Ÿï¼‰

#### 1.1 æ‰“å¼€ç»ˆç«¯ï¼Œå®‰è£… Wranglerï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰

```bash
npm install -g wrangler
```

#### 1.2 ç™»å½• Cloudflare

```bash
wrangler login
```

è¿™ä¼šæ‰“å¼€æµè§ˆå™¨ï¼Œç™»å½•æ‚¨çš„ Cloudflare è´¦å·ã€‚

#### 1.3 åˆ›å»ºæ•°æ®åº“

```bash
wrangler d1 create fiverr-articles
```

**é‡è¦ï¼** æ‰§è¡Œåä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„è¾“å‡ºï¼š

```
âœ… Successfully created DB 'fiverr-articles'

[[d1_databases]]
binding = "DB"
database_name = "fiverr-articles"
database_id = "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"  â¬…ï¸ å¤åˆ¶è¿™ä¸ª IDï¼
```

**ğŸ“‹ å¤åˆ¶ `database_id` çš„å€¼ï¼** æ¥ä¸‹æ¥ä¼šç”¨åˆ°ã€‚

---

### ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–æ•°æ®åº“è¡¨ç»“æ„ï¼ˆ1åˆ†é’Ÿï¼‰

åœ¨é¡¹ç›®ç›®å½•æ‰§è¡Œï¼š

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd d:\cursorproject\fiverr

# åˆå§‹åŒ–æ•°æ®åº“ï¼ˆåˆ›å»º articles è¡¨ï¼‰
wrangler d1 execute fiverr-articles --file=./db/schema.sql --remote
```

**âœ… çœ‹åˆ° "Success" å°±è¡¨ç¤ºæ•°æ®åº“è¡¨åˆ›å»ºæˆåŠŸï¼**

---

### ç¬¬ä¸‰æ­¥ï¼šåœ¨ Cloudflare Dashboard ç»‘å®šæ•°æ®åº“ï¼ˆ2åˆ†é’Ÿï¼‰â­

è¿™æ˜¯**æœ€å…³é”®**çš„ä¸€æ­¥ï¼

#### 3.1 è®¿é—® Cloudflare Dashboard

1. æ‰“å¼€ https://dash.cloudflare.com
2. ç‚¹å‡»å·¦ä¾§ **Workers & Pages**
3. æ‰¾åˆ°å¹¶ç‚¹å‡»æ‚¨çš„é¡¹ç›®ï¼ˆä¸Šä¼  zip ååˆ›å»ºçš„é¡¹ç›®ï¼‰

#### 3.2 é…ç½®æ•°æ®åº“ç»‘å®š

1. ç‚¹å‡» **Settings**ï¼ˆè®¾ç½®ï¼‰
2. æ‰¾åˆ° **Functions** é€‰é¡¹å¡
3. å‘ä¸‹æ»šåŠ¨åˆ° **D1 database bindings**
4. ç‚¹å‡» **Add binding**ï¼ˆæ·»åŠ ç»‘å®šï¼‰

#### 3.3 å¡«å†™ç»‘å®šä¿¡æ¯

```
Variable name: DB
D1 database: fiverr-articles
```

**âš ï¸ æ³¨æ„ï¼š**
- **Variable name å¿…é¡»æ˜¯ `DB`ï¼ˆå…¨å¤§å†™ï¼‰**
- D1 database é€‰æ‹©åˆšæ‰åˆ›å»ºçš„ `fiverr-articles`

5. ç‚¹å‡» **Save**ï¼ˆä¿å­˜ï¼‰

---

### ç¬¬å››æ­¥ï¼šé‡æ–°éƒ¨ç½²ï¼ˆ30ç§’ï¼‰

ç»‘å®šæ•°æ®åº“åï¼Œéœ€è¦é‡æ–°éƒ¨ç½²æ‰èƒ½ç”Ÿæ•ˆï¼š

#### æ–¹æ³• 1ï¼šåœ¨ Dashboard é‡æ–°éƒ¨ç½²

1. ç‚¹å‡» **Deployments**ï¼ˆéƒ¨ç½²ï¼‰
2. æ‰¾åˆ°æœ€æ–°çš„éƒ¨ç½²è®°å½•
3. ç‚¹å‡»å³ä¾§çš„ **Â·Â·Â·** èœå•
4. é€‰æ‹© **Retry deployment**ï¼ˆé‡è¯•éƒ¨ç½²ï¼‰æˆ– **Redeploy**

#### æ–¹æ³• 2ï¼šé‡æ–°ä¸Šä¼ 

å¦‚æœæ²¡æœ‰ Retry é€‰é¡¹ï¼Œå¯ä»¥é‡æ–°ä¸Šä¼  `fiverr-deploy.zip`ã€‚

---

### ç¬¬äº”æ­¥ï¼šéªŒè¯é…ç½®ï¼ˆ1åˆ†é’Ÿï¼‰

#### 5.1 æ£€æŸ¥éƒ¨ç½²æ—¥å¿—

1. åœ¨ **Deployments** é¡µé¢
2. ç‚¹å‡»æœ€æ–°çš„éƒ¨ç½²
3. æŸ¥çœ‹ **Build logs**
4. ç¡®ä¿æ²¡æœ‰é”™è¯¯

#### 5.2 è®¿é—®ç½‘ç«™

éƒ¨ç½²å®Œæˆåï¼Œè®¿é—®æ‚¨çš„ç½‘ç«™ï¼š
```
https://æ‚¨çš„é¡¹ç›®å.pages.dev
```

#### 5.3 æµ‹è¯•åŠŸèƒ½

1. è®¿é—®é¦–é¡µï¼š`https://æ‚¨çš„é¡¹ç›®å.pages.dev`
2. è®¿é—®æ–‡ç« åˆ—è¡¨ï¼š`https://æ‚¨çš„é¡¹ç›®å.pages.dev/articles`
3. è®¿é—®ç®¡ç†åå°ï¼š`https://æ‚¨çš„é¡¹ç›®å.pages.dev/admin`

---

## ğŸ–¼ï¸ å›¾ç¤ºè¯´æ˜

### åœ¨å“ªé‡Œæ‰¾åˆ° D1 database bindingsï¼Ÿ

```
Cloudflare Dashboard
â””â”€â”€ Workers & Pages
    â””â”€â”€ æ‚¨çš„é¡¹ç›®
        â””â”€â”€ Settings
            â””â”€â”€ Functions
                â””â”€â”€ D1 database bindings  â¬…ï¸ åœ¨è¿™é‡Œï¼
                    â””â”€â”€ Add binding
                        â”œâ”€â”€ Variable name: DB
                        â””â”€â”€ D1 database: fiverr-articles
```

---

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: å‘½ä»¤è¡Œæç¤ºæ‰¾ä¸åˆ° wranglerï¼Ÿ

**è§£å†³æ–¹æ³•ï¼š**
```bash
# å…¨å±€å®‰è£…
npm install -g wrangler

# æˆ–ä½¿ç”¨ npx
npx wrangler login
npx wrangler d1 create fiverr-articles
```

### Q2: wrangler login æ‰“ä¸å¼€æµè§ˆå™¨ï¼Ÿ

**è§£å†³æ–¹æ³•ï¼š**
```bash
# ä¼šæ˜¾ç¤ºä¸€ä¸ªé“¾æ¥ï¼Œæ‰‹åŠ¨å¤åˆ¶åˆ°æµè§ˆå™¨æ‰“å¼€
wrangler login
```

### Q3: æ‰¾ä¸åˆ° DB binding çš„è®¾ç½®ï¼Ÿ

**æ£€æŸ¥è·¯å¾„ï¼š**
1. Cloudflare Dashboard é¦–é¡µ
2. å·¦ä¾§èœå• â†’ **Workers & Pages**
3. ç‚¹å‡»æ‚¨çš„é¡¹ç›®åç§°ï¼ˆä¸æ˜¯ Workersï¼‰
4. ä¸Šæ–¹æ ‡ç­¾ â†’ **Settings**
5. ä¸‹æ–¹æ ‡ç­¾ â†’ **Functions**
6. å‘ä¸‹æ»šåŠ¨ â†’ **D1 database bindings**

### Q4: ç»‘å®šåè¿˜æ˜¯ä¸å·¥ä½œï¼Ÿ

**æ£€æŸ¥æ¸…å•ï¼š**
- [ ] Variable name æ˜¯ `DB`ï¼ˆå¤§å†™ï¼‰
- [ ] å·²æ‰§è¡Œ `schema.sql` åˆå§‹åŒ–è¡¨
- [ ] ç»‘å®šåé‡æ–°éƒ¨ç½²äº†
- [ ] ç­‰å¾… 1-2 åˆ†é’Ÿè®©éƒ¨ç½²å®Œæˆ

### Q5: æ˜¾ç¤º "database not found"ï¼Ÿ

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ£€æŸ¥æ•°æ®åº“æ˜¯å¦åˆ›å»ºæˆåŠŸ
wrangler d1 list

# åº”è¯¥èƒ½çœ‹åˆ° fiverr-articles
# å¦‚æœæ²¡æœ‰ï¼Œé‡æ–°åˆ›å»º
wrangler d1 create fiverr-articles
```

### Q6: æˆ‘ä¸æƒ³ç”¨å‘½ä»¤è¡Œï¼Œæœ‰å…¶ä»–æ–¹æ³•å—ï¼Ÿ

**å¯ä»¥åœ¨ Dashboard åˆ›å»ºï¼š**

1. Cloudflare Dashboard â†’ **Workers & Pages**
2. å·¦ä¾§ â†’ **D1**
3. ç‚¹å‡» **Create database**
4. æ•°æ®åº“åç§°ï¼š`fiverr-articles`
5. åˆ›å»ºåï¼Œç‚¹å‡»æ•°æ®åº“åç§°
6. ç‚¹å‡» **Console** æ ‡ç­¾
7. ç²˜è´´ `db/schema.sql` çš„å†…å®¹å¹¶æ‰§è¡Œ

---

## ğŸ“‹ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# 1. ç™»å½•
wrangler login

# 2. åˆ›å»ºæ•°æ®åº“
wrangler d1 create fiverr-articles

# 3. åˆå§‹åŒ–è¡¨ç»“æ„
wrangler d1 execute fiverr-articles --file=./db/schema.sql --remote

# 4. æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“
wrangler d1 list

# 5. æŸ¥çœ‹æ•°æ®åº“å†…å®¹
wrangler d1 execute fiverr-articles --command "SELECT * FROM articles" --remote

# 6. å¤‡ä»½æ•°æ®åº“
wrangler d1 export fiverr-articles --remote --output=backup.sql
```

---

## ğŸ¯ å®Œæ•´é…ç½®æ£€æŸ¥æ¸…å•

æŒ‰é¡ºåºæ£€æŸ¥ï¼š

1. [ ] å·²å®‰è£… wranglerï¼š`wrangler --version`
2. [ ] å·²ç™»å½• Cloudflareï¼š`wrangler whoami`
3. [ ] å·²åˆ›å»ºæ•°æ®åº“ï¼š`wrangler d1 list`ï¼ˆèƒ½çœ‹åˆ° fiverr-articlesï¼‰
4. [ ] å·²åˆå§‹åŒ–è¡¨ï¼š`wrangler d1 execute fiverr-articles --command "SELECT name FROM sqlite_master WHERE type='table'" --remote`ï¼ˆèƒ½çœ‹åˆ° articlesï¼‰
5. [ ] å·²åœ¨ Dashboard ç»‘å®šæ•°æ®åº“ï¼ˆVariable name = `DB`ï¼‰
6. [ ] å·²é‡æ–°éƒ¨ç½²
7. [ ] ç½‘ç«™èƒ½æ­£å¸¸è®¿é—®

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœæŒ‰ç…§ä»¥ä¸Šæ­¥éª¤è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œè¯·æä¾›ï¼š

1. **é”™è¯¯ä¿¡æ¯**ï¼ˆæµè§ˆå™¨æ§åˆ¶å°æˆ–éƒ¨ç½²æ—¥å¿—ï¼‰
2. **é¡¹ç›® URL**ï¼ˆæ‚¨çš„ .pages.dev åœ°å€ï¼‰
3. **Database ID**ï¼ˆæ£€æŸ¥æ˜¯å¦æ­£ç¡®åˆ›å»ºï¼‰

---

**âœ¨ å®Œæˆè¿™äº›æ­¥éª¤åï¼Œæ‚¨çš„ç½‘ç«™å°±èƒ½æ­£å¸¸è¿è¡Œäº†ï¼**

